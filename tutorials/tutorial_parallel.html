<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creating a Parallel Model &mdash; cuda_hybrid 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Customizing Models" href="tutorial_obesity.html" />
    <link rel="prev" title="Running a Model Serially" href="tutorial_serial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> cuda_hybrid
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial_serial.html">Running a Model Serially</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Creating a Parallel Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_obesity.html">Customizing Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_visualization.html">Data Visualization Using Seaborn</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribution.html">Contribution</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cuda_hybrid</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Tutorials</a> &raquo;</li>
      <li>Creating a Parallel Model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/tutorial_parallel.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="creating-a-parallel-model">
<h1>Creating a Parallel Model<a class="headerlink" href="#creating-a-parallel-model" title="Permalink to this headline"></a></h1>
<p>The model used here is similar to the one in the serial use case, except that the
simulation will be run for 100 steps and there will be 100 agents. This is to show the difference
between the runtimes of the two versions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details about the model, please refer to <a class="reference internal" href="tutorial_serial.html#running-a-model-serially"><span class="std std-ref">the serial use case</span></a>.</p>
</div>
<p>In a python file, import the <a class="reference internal" href="../docs.html#cuda_hybrid.generate_model" title="cuda_hybrid.generate_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_model</span></code></a>
and <code class="xref py py-func docutils literal notranslate"><span class="pre">cuda_main</span></code> methods from the package:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cuda_hybrid</span> <span class="kn">import</span> <span class="n">generate_model</span><span class="p">,</span> <span class="n">cuda_main</span>
</pre></div>
</div>
<p>The model will be built using <a class="reference internal" href="../docs.html#cuda_hybrid.generate_model" title="cuda_hybrid.generate_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_model</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hm</span> <span class="o">=</span> <span class="n">generate_model</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;insurgency.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;watts&#39;</span><span class="p">,</span> <span class="n">nx</span><span class="o">.</span><span class="n">community</span><span class="o">.</span><span class="n">label_propagation_communities</span><span class="p">)</span>
</pre></div>
</div>
<p>After that, get the indices of the nodes that will participate in the interactions between agents:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">econIdx</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">fcm_labels</span><span class="p">[</span><span class="s1">&#39;EconomicDevelopment&#39;</span><span class="p">]</span>
<span class="n">insurIdx</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">fcm_labels</span><span class="p">[</span><span class="s2">&quot;AbilityOfInsurgentsToControlThePopulation&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>and then pass them, along with other arguments, which includes the hybridmodel object,
a list of focus nodes, a list of thresholds for the focus nodes, the maximun number of iterations for FCM, a numpy array
of arguments for the interaction functions, and optionally, number of steps, to the <code class="xref py py-func docutils literal notranslate"><span class="pre">cuda_main</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cuda_main</span><span class="p">(</span><span class="n">hm</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Rebelliousness&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">econIdx</span><span class="p">,</span> <span class="n">insurIdx</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
</pre></div>
</div>
<p>Five first line of results are displayed below:</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Intput</span><a class="headerlink" href="#id1" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ED</p></th>
<th class="head"><p>R</p></th>
<th class="head"><p>AICP</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>4.564926326274871826e-01</p></td>
<td><p>2.775330543518066406e-01</p></td>
<td><p>4.507533609867095947e-01</p></td>
</tr>
<tr class="row-odd"><td><p>9.663465619087219238e-01</p></td>
<td><p>9.071657061576843262e-01</p></td>
<td><p>5.098578929901123047e-01</p></td>
</tr>
<tr class="row-even"><td><p>7.286615371704101562e-01</p></td>
<td><p>9.334620088338851929e-02</p></td>
<td><p>7.892300486564636230e-01</p></td>
</tr>
<tr class="row-odd"><td><p>1.165298745036125183e-01</p></td>
<td><p>5.919184088706970215e-01</p></td>
<td><p>5.640574097633361816e-01</p></td>
</tr>
<tr class="row-even"><td><p>9.065104126930236816e-01</p></td>
<td><p>8.411430120468139648e-01</p></td>
<td><p>5.168997645378112793e-01</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Output</span><a class="headerlink" href="#id2" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ED</p></th>
<th class="head"><p>R</p></th>
<th class="head"><p>AICP</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.268030285835266113e-01</p></td>
<td><p>5.754823684692382812e-01</p></td>
<td><p>6.590460538864135742e-01</p></td>
</tr>
<tr class="row-odd"><td><p>8.268030285835266113e-01</p></td>
<td><p>5.754823684692382812e-01</p></td>
<td><p>6.590460538864135742e-01</p></td>
</tr>
<tr class="row-even"><td><p>8.268030285835266113e-01</p></td>
<td><p>5.754823684692382812e-01</p></td>
<td><p>6.590460538864135742e-01</p></td>
</tr>
<tr class="row-odd"><td><p>8.268030285835266113e-01</p></td>
<td><p>5.754823684692382812e-01</p></td>
<td><p>6.590460538864135742e-01</p></td>
</tr>
</tbody>
</table>
<p>The recorded time of the parallel version was <code class="docutils literal notranslate"><span class="pre">1.3296318054199219</span></code> seconds,
while that of the serial version was <code class="docutils literal notranslate"><span class="pre">5.328189849853516</span></code> seconds.</p>
<p>The complete files for the input and output can be found here:</p>
<p><a class="reference download internal" download="" href="../_downloads/b50fca7e125087f3960e5b9f74dcf39a/out_100.csv"><code class="xref download docutils literal notranslate"><span class="pre">output.csv</span></code></a></p>
<p><a class="reference download internal" download="" href="../_downloads/291c80fb76e7916ceb35345871a0a23e/insurgency_100.csv"><code class="xref download docutils literal notranslate"><span class="pre">input.csv</span></code></a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial_serial.html" class="btn btn-neutral float-left" title="Running a Model Serially" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial_obesity.html" class="btn btn-neutral float-right" title="Customizing Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kareem Ghumrawi, Philippe J. Giabbanelli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>